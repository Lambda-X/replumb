<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>replumb.ast documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Replumb</span> <span class="project-version">0.2.0</span></span></a></h1></div><div class="sidebar primary"><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replumb</span></div></div></li><li class="depth-2 branch current"><a href="replumb.ast.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ast</span></div></a></li><li class="depth-2"><a href="replumb.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="replumb.ast.html#var-dissoc-all"><div class="inner"><span>dissoc-all</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-dissoc-import"><div class="inner"><span>dissoc-import</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-dissoc-macro"><div class="inner"><span>dissoc-macro</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-dissoc-macro-require"><div class="inner"><span>dissoc-macro-require</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-dissoc-ns"><div class="inner"><span>dissoc-ns</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-dissoc-require"><div class="inner"><span>dissoc-require</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-dissoc-symbol"><div class="inner"><span>dissoc-symbol</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-empty-state.3F"><div class="inner"><span>empty-state?</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-get-state"><div class="inner"><span>get-state</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-import-of-ns.3F"><div class="inner"><span>import-of-ns?</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-imports"><div class="inner"><span>imports</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-known-namespaces"><div class="inner"><span>known-namespaces</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-macro-of-ns.3F"><div class="inner"><span>macro-of-ns?</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-macro-requires"><div class="inner"><span>macro-requires</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-macros"><div class="inner"><span>macros</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-namespace"><div class="inner"><span>namespace</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-ns-defs"><div class="inner"><span>ns-defs</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-ns-interns"><div class="inner"><span>ns-interns</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-ns-publics"><div class="inner"><span>ns-publics</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-require-of-ns.3F"><div class="inner"><span>require-of-ns?</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-requires"><div class="inner"><span>requires</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-symbol-of-ns.3F"><div class="inner"><span>symbol-of-ns?</span></div></a></li><li class="depth-1"><a href="replumb.ast.html#var-symbols"><div class="inner"><span>symbols</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">replumb.ast</h1><div class="doc"><div class="markdown"><p>Thin layer of helpers over the ClojureScript Abstract syntax tree (AST)</p></div></div><div class="public anchor" id="var-dissoc-all"><h3>dissoc-all</h3><div class="usage"><code>(dissoc-all state requirer-ns required-ns)</code><code>(dissoc-all state requirer-ns required-ns type)</code></div><div class="doc"><div class="markdown"><p>Dissoc all the required-ns symbols from requirer-ns.</p>
<p>There are three types of symbol in replumb jargon, which loosely map to <code>cljs.js</code> ones. These optionally go in the type parameter as keyword:</p>
<ul>
  <li><code>:symbol</code>, the default, for instance my-sym in <code>(def my-sym 3)</code></li>
  <li><code>:macro</code>, which comes from a <code>(defmacro ...)</code></li>
  <li><code>:import</code>, for instance User in <code>(import &#39;foo.bar.User)</code></li>
  <li><code>:require</code>, which is the namespace symbol in a <code>(require ...)</code></li>
  <li><code>:macro-require</code>, which is the namespace symbol in a <code>(require-macros ...)</code></li>
</ul>
<p>This is the only function in the lot that also reliably clears namespace aliases.</p></div></div></div><div class="public anchor" id="var-dissoc-import"><h3>dissoc-import</h3><div class="usage"><code>(dissoc-import state requirer-ns sym)</code></div><div class="doc"><div class="markdown"><p>Dissoc the imported symbol from the compiler state.</p></div></div></div><div class="public anchor" id="var-dissoc-macro"><h3>dissoc-macro</h3><div class="usage"><code>(dissoc-macro state requirer-ns sym)</code></div><div class="doc"><div class="markdown"><p>Dissoc a macro symbol from the compiler state given the symbol of the namespace where <code>require-macros</code> (or <code>use-macros</code>) was called from.</p></div></div></div><div class="public anchor" id="var-dissoc-macro-require"><h3>dissoc-macro-require</h3><div class="usage"><code>(dissoc-macro-require state requirer-ns required-ns)</code></div><div class="doc"><div class="markdown"><p>Dissoc the macro required-ns from requirer-ns.</p>
<p>For instance after:</p>
<pre><code>(in-ns &#39;cljs.user)          ;; requirer-ns
(require-macros &#39;cljs.test) ;; required-ns
</code></pre>
<p>You can use the following to clean the compiler state:</p>
<pre><code>(dissoc-macro-require repl/st &#39;cljs.user &#39;cljs.test)
</code></pre>
<p>This util function does not remove aliases. See <code>replumb.ast/dissoc-all</code>.</p></div></div></div><div class="public anchor" id="var-dissoc-ns"><h3>dissoc-ns</h3><div class="usage"><code>(dissoc-ns state ns)</code></div><div class="doc"><div class="markdown"><p>Dissoc the namespace symbol from the compiler state.</p></div></div></div><div class="public anchor" id="var-dissoc-require"><h3>dissoc-require</h3><div class="usage"><code>(dissoc-require state requirer-ns required-ns)</code></div><div class="doc"><div class="markdown"><p>Dissoc the required-ns from requirer-ns.</p>
<p>For instance after:</p>
<pre><code>(in-ns &#39;cljs.user)        ;; requirer-ns
(require &#39;clojure.string) ;; required-ns
</code></pre>
<p>You can use the following to clean the compiler state:</p>
<pre><code>(dissoc-require repl/st &#39;cljs.user &#39;clojure.string)
</code></pre>
<p>This util function does not remove aliases. See <code>replumb.ast/dissoc-all</code>.</p></div></div></div><div class="public anchor" id="var-dissoc-symbol"><h3>dissoc-symbol</h3><div class="usage"><code>(dissoc-symbol state requirer-ns sym)</code></div><div class="doc"><div class="markdown"><p>Dissoc symbol from the compiler state given the symbol of the namespace where <code>require</code> (or <code>use</code>) was called from.</p></div></div></div><div class="public anchor" id="var-empty-state.3F"><h3>empty-state?</h3><div class="usage"><code>(empty-state? state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Return true if the compiler state is empty.</p>
<p>In other words if <code>(every? empty? (vals (replumb.ast/get-state ...)</code> returns true for the input requirer-ns.</p>
<p>In replumb jargon:</p>
<pre><code>(in-ns &#39;cljs.user)          ;; requirer-ns
(require-macros &#39;cljs.test) ;; required-ns
</code></pre></div></div></div><div class="public anchor" id="var-get-state"><h3>get-state</h3><div class="usage"><code>(get-state state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Retrieves a map with the state details for the input requirer-ns.</p>
<p>In replumb jargon:</p>
<pre><code>(in-ns &#39;cljs.user)          ;; requirer-ns
(require-macros &#39;cljs.test) ;; required-ns
</code></pre>
<p>And the returned map is (on the right, the compiler AST real key):</p>
<pre><code>{:requires (replumb.ast/requires ...)             ;; :requires
 :macro-requires (replumb.ast/macro-requires ...) ;; :require-macros
 :symbols (replumb.ast/symbols ...)               ;; :uses
 :macros (replumb.ast/macros ...)                 ;; :use-macros
 :imports (replumb.ast/imports ...)}              ;; :imports
</code></pre></div></div></div><div class="public anchor" id="var-import-of-ns.3F"><h3>import-of-ns?</h3><div class="usage"><code>(import-of-ns? ns sym)</code></div><div class="doc"><div class="markdown"><p>Yields true when sym belongs to ns.</p>
<p>This typically works on the output of <code>replumb.ast/imports</code>.</p></div></div></div><div class="public anchor" id="var-imports"><h3>imports</h3><div class="usage"><code>(imports state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Return imported symbols given compiler state and a namespace: a map of <code>{symbol1 ns, symbol2 ns, ...}</code>.</p>
<p>Note that an <code>import</code> symbol is the final segment only, so <code>User</code> in the <code>foo.bar.User</code></p>
<p>You need a <code>import</code> in the requirer-ns namespace for this to return something.</p></div></div></div><div class="public anchor" id="var-known-namespaces"><h3>known-namespaces</h3><div class="usage"><code>(known-namespaces state)</code></div><div class="doc"><div class="markdown"><p>Given a compiler state, return the seq of namespace symbols currently present in the AST.</p></div></div></div><div class="public anchor" id="var-macro-of-ns.3F"><h3>macro-of-ns?</h3><div class="usage"><code>(macro-of-ns? ns sym)</code></div><div class="doc"><div class="markdown"><p>Yields true when the sym belongs to ns.</p>
<p>This typically works on the output of <code>replumb.ast/macros</code>.</p></div></div></div><div class="public anchor" id="var-macro-requires"><h3>macro-requires</h3><div class="usage"><code>(macro-requires state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Return all the required macro namespaces given compiler state and a namespace: a map of <code>{macro-ns1 macro-ns1, macro-ns2 macro-ns2, ...}</code>.</p>
<p>You need a <code>require-macros</code> in the requirer-ns namespace for this to return something.</p></div></div></div><div class="public anchor" id="var-macros"><h3>macros</h3><div class="usage"><code>(macros state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Return all the macro symbols given compiler state and namespace: a map of <code>{macro-symbol1 macro-ns, macro-symbol2 macro-ns}</code>.</p>
<p>You need a <code>:refer</code> in the requirer-ns namespace for this to return something.</p></div></div></div><div class="public anchor" id="var-namespace"><h3>namespace</h3><div class="usage"><code>(namespace state ns)</code></div><div class="doc"><div class="markdown"><p>Given compiler state and namespace symbol, returns its whole AST content.</p>
<p>Beware, there can be a lot of data.</p></div></div></div><div class="public anchor" id="var-ns-defs"><h3>ns-defs</h3><div class="usage"><code>(ns-defs state ns)</code></div><div class="doc"><div class="markdown"><p>Given compiler state and namespace symbol, returns its AST&rsquo;s <code>:defs</code> key content.</p>
<p>Beware, there can be a lot of data.</p></div></div></div><div class="public anchor" id="var-ns-interns"><h3>ns-interns</h3><div class="usage"><code>(ns-interns state ns)</code></div><div class="doc"><div class="markdown"><p>Given compiler state and namespace symbol return all the vars in the AST.</p>
<p>Analogous to <code>cljs.analyzer/ns-interns</code>, but it returns analysis maps not vars.</p>
<p>Beware, there can be a lot of data.</p></div></div></div><div class="public anchor" id="var-ns-publics"><h3>ns-publics</h3><div class="usage"><code>(ns-publics state ns)</code></div><div class="doc"><div class="markdown"><p>Given compiler state and namespace symbol return all the public vars in the AST.</p>
<p>Analogous to <code>cljs.analyzer/ns-publics</code>, but it returns analysis maps not vars.</p>
<p>Beware, there can be a lot of data.</p></div></div></div><div class="public anchor" id="var-require-of-ns.3F"><h3>require-of-ns?</h3><div class="usage"><code>(require-of-ns? ns sym)</code></div><div class="doc"><div class="markdown"><p>Yields true when the symbol belongs to ns.</p>
<p>This typically works on the output of either <code>replumb.ast/requires</code> or <code>replumb.ast/macro-requires</code>.</p></div></div></div><div class="public anchor" id="var-requires"><h3>requires</h3><div class="usage"><code>(requires state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Return required symbols given compiler state and namespace: a map of <code>{ns ns, another-ns another-ns, ...}</code>.</p>
<p>Note that <code>import</code> also adds something to the AST&rsquo;s <code>:requires</code> key of the requirer-ns, see <code>replumb.ast/dissoc-import</code>.</p>
<p>You need a <code>require</code> in the requirer-ns namespace for this to return something.</p></div></div></div><div class="public anchor" id="var-symbol-of-ns.3F"><h3>symbol-of-ns?</h3><div class="usage"><code>(symbol-of-ns? ns sym)</code></div><div class="doc"><div class="markdown"><p>Yields true when the symbol belongs to ns.</p>
<p>This typically works on the output of <code>replumb.ast/symbols</code>.</p></div></div></div><div class="public anchor" id="var-symbols"><h3>symbols</h3><div class="usage"><code>(symbols state requirer-ns)</code></div><div class="doc"><div class="markdown"><p>Return referred/used symbols given compiler state and a namespace: a map of <code>{symbol1 ns, symbol2 ns, ...}</code>.</p>
<p>You need a <code>:refer</code> in the requirer-ns namespace for this to return something.</p></div></div></div></div></body></html>